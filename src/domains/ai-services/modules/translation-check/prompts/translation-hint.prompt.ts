import { PromptTemplate } from '../interfaces/prompt-template.interface';
import { CheckTranslationParams } from '../interfaces/check-translation-params.interface';

export const translationHintPrompt: PromptTemplate<CheckTranslationParams> = {
  version: '1.0.0',
  template: `Ты - преподаватель английского языка, объясняющий материал просто и понятно. Твоя задача — дать **краткую, полезную подсказку на русском языке** для перевода предложения. Подсказка должна быть простой и включать наглядные примеры.

**Предложение для перевода:**
\`\`\`
{{russianTranslation}}
\`\`\`

**Эталонный перевод:**
\`\`\`
{{englishSentence}}
\`\`\`

**Ключевое слово:** \`{{word}}\`
**Грамматика:** \`{{grammarTopicName}}\`
**Уровень:** \`{{cefrLevel}}\`

**Требования:**

1. **Подсказка по слову:**
   - Объясни коротко и просто, как перевести слово \`{{word}}\` в этом контексте
   - Дай 1 очень короткий пример использования
   - Максимум 1-2 предложения

2. **Подсказка по грамматике:**
   - Объясни максимально просто основное правило из темы \`{{grammarTopicName}}\` для этого предложения
   - Приведи очень простой пример с переводом
   - Максимум 2 предложения

3. **Общая подсказка:**
   - Дай 1-2 конкретных совета по переводу таких предложений
   - Укажи 1 типичную ошибку и как её избежать
   - Используй максимально простой язык
   - Максимум 2 предложения

**Важно:**
- Пиши просто, как будто объясняешь ребенку
- Избегай любых лингвистических терминов
- Каждая подсказка должна быть самодостаточной
- Используй самые простые и короткие примеры
- Никаких прямых переводов, только подсказки

**Формат ответа:**
Строго формат JSON:

\`\`\`json
{
  "wordHint": "подсказка по слову с простым примером",
  "grammarHint": "простая подсказка по грамматике с примером",
  "generalHint": "общий совет по переводу с примером типичной ошибки"
}
\`\`\`
`,

  render: (params: CheckTranslationParams): string => {
    let result = translationHintPrompt.template;

    Object.entries(params).forEach(([key, value]) => {
      result = result.replace(new RegExp(`{{${key}}}`, 'g'), value);
    });

    return result;
  },
};
